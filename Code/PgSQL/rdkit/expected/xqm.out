-- parsing and conversion to text
select mol_to_xqmol('Cc1n[nH]c(F)c1'::mol);
                                                                                                                                                                                                                                                                                                                                                                                                                              mol_to_xqmol                                                                                                                                                                                                                                                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
     "xqm_type": "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     "tautomers": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMGUCgAAAADBBkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsHUCgAAAADAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsHcDgAAAADAQMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlAoAAAAAwQZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgMAAAAAAAAAHAArCQAgAAAAAQZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQJoDAIDaAwDBGgMBAUABAZoDAYBaAwUAQAAAAUBAgMEBhcEAAAAAAAAABY=",                                                                                                            +
             "smarts": "[#6]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D3](-[#9]):[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
         },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMGUCgAAAADBBkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsHUDgAAAADAQMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArB3AoAAAAAwMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlAoAAAAAwQZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgMAAAAAAAAAHAArCQAgAAAAAQZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQJoDAIDaAwDBGgMBAUABAZoDAYBaAwUAQAAAAUBAgMEBhcEAAAAAAAAABY=",                                                                                                            +
             "smarts": "[#6]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D3](-[#9]):[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
         }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
     ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "template": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
         "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMGUCgAAAADARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsHECgAAAAAAhkNAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcACsHECgAAAAAAhkNAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcACsGUCgAAAADARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsJACAAAAABBlAIAAAAAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQIYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsCA2gMAwQYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsEBQAEBhgAGRwAAABTaW5nbGVPckRvdWJsZU9yQXJvbWF0aWNCb25kIRoBAAAAAAAAABwAKwYBGAAZHAAAAFNpbmdsZU9yRG91YmxlT3JBcm9tYXRpY0JvbmQhGgEAAAAAAAAAHAArFAEAAAAFAQIDBAYXBAAAAAAAAAAW",+
         "smarts": "[#6]-[#6&D3]1-,=,:[#7]:[#7]-,=,:[#6&D3](-[#9])-,=,:[#6&D2]-,=,:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "modifiedAtoms": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
         "2",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "3"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
     ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "modifiedBonds": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
         "1",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "5",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "6"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
     ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
 
(1 row)

select mol_to_xqmol('COC |LN:1:1.3|'::mol);
                                                                      mol_to_xqmol                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                     +
     "xqm_type": "2",                                                                                                                                  +
     "mols": [                                                                                                                                         +
         {                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAADAAAAAgAAAIABBgBoAAAAAAEDCAAoAAAAAAIGAGgAAAAAAQMLAAEAAQIAFwQAAAAAAAAAFg==",                            +
             "smiles": "COC"                                                                                                                           +
         },                                                                                                                                            +
         {                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAEAAAAAwAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAgYAaAAAAAABAwsAAQABAgACAwAXBAAAAAAAAAAW",                +
             "smiles": "COOC"                                                                                                                          +
         },                                                                                                                                            +
         {                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAFAAAABAAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAggAKAAAAAACBgBoAAAAAAEDCwABAAECAAIDAAMEABcEAAAAAAAAABY=",+
             "smiles": "COOOC"                                                                                                                         +
         }                                                                                                                                             +
     ]                                                                                                                                                 +
 }                                                                                                                                                     +
 
(1 row)

select mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol);
                                                                                                                                                                                                                                                                                                                                                                                                                                                  mol_to_xqmol                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
     "xqm_type": "4",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
     "num_entries": "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
     "tautomerQueries": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
             "tautomers": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
                     "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBoAAAAAAEDCAAoAAAAAAIGUCgAAAAABBkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsHUCgAAAADAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArB1A4AAAAAwEDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQIAAgNIDAQCSAwDBUgMBgRIDAUGSAwUAQAAAAUCAwUGBBcEAAAAAAAAABY=",                                                                                                                                        +
                     "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
                     "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArB3AoAAAAAwMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAiACA2gMBAJoDAMFaAwGBGgMBQZoDBQBAAAABQIDBQYEFwQAAAAAAAAAFg==",                                                                                                                                        +
                     "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "template": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
                 "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBoAAAAAAEDCAAoAAAAAAIGUCgAAAAAARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsHECgAAAAAAhkNAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcACsGUAgAAAADGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwcQKAAAAAACGQ0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAKwZQCAAAAAMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArCwABAAECAAIDGAAZHAAAAFNpbmdsZU9yRG91YmxlT3JBcm9tYXRpY0JvbmQhGgEAAAAAAAAAHAArBAIYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsDBUgMBgQYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsFBhgAGRwAAABTaW5nbGVPckRvdWJsZU9yQXJvbWF0aWNCb25kIRoBAAAAAAAAABwAKxQBAAAABQIDBQYEFwQAAAAAAAAAFg==",                            +
                 "smarts": "[#6]-[#8]-[#6&D3]1-,=,:[#7]:[#7]-,=,:[#6&D2]-,=,:[#6&D2]-,=,:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
             },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "modifiedAtoms": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "5"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
             ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "modifiedBonds": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 "2",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "5",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "6"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
             ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
         },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
             "tautomers": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
                     "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAIAAAACAAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAgZQKAAAAAAEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQKAAAAAMDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsHUDgAAAADAQMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAgACAwADBEgMBQNIDAQGSAwHBUgMBgdIDBQBAAAABQMEBgcFFwQAAAAAAAAAFg==",                                                                                                                        +
                     "smarts": "[#6]-[#8]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
                 },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
                     "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAIAAAACAAAAIABBgBgAAAAAQMIACAAAAACCAAoAAAAAwIGUCgAAAADBBkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsHUDgAAAADAQMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwdwKAAAAAMDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQIAAgMgAwRoDAUDaAwEBmgMBwVoDAYHaAwUAQAAAAUDBAYHBRcEAAAAAAAAABY=",                                                                                                                            +
                     "smarts": "[#6]-[#8]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
                 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "template": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
                 "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAIAAAACAAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAgZQKAAAAAABGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwcQKAAAAAACGQ0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAKwZQCAAAAAMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBxAoAAAAAAIZDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAArBlAIAAAAAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQIAAgMAAwQYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsFAxgAGRwAAABTaW5nbGVPckRvdWJsZU9yQXJvbWF0aWNCb25kIRoBAAAAAAAAABwAKwQGSAwHBRgAGRwAAABTaW5nbGVPckRvdWJsZU9yQXJvbWF0aWNCb25kIRoBAAAAAAAAABwAKwYHGAAZHAAAAFNpbmdsZU9yRG91YmxlT3JBcm9tYXRpY0JvbmQhGgEAAAAAAAAAHAArFAEAAAAFAwQGBwUXBAAAAAAAAAAW",                +
                 "smarts": "[#6]-[#8]-[#8]-[#6&D3]1-,=,:[#7]:[#7]-,=,:[#6&D2]-,=,:[#6&D2]-,=,:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
             },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "modifiedAtoms": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 "4",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "6"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
             ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "modifiedBonds": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "4",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "6",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "7"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
             ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
         },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
             "tautomers": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
                     "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAJAAAACQAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAggAKAAAAAACBlAoAAAAAAQZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgMAAAAAAAAAHAArB1AoAAAAAwMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArCwABAAECAAIDAAMEAAQFSAwGBEgMBQdIDAgGSAwHCEgMFAEAAAAFBAUHCAYXBAAAAAAAAAAW",                                                                                                            +
                     "smarts": "[#6]-[#8]-[#8]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
                     "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAJAAAACQAAAIABBgBgAAAAAQMIACAAAAACCAAgAAAAAggAKAAAAAMCBlAoAAAAAwQZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgMAAAAAAAAAHAArB1A4AAAAAwEDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsHcCgAAAADAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArCwABAAECAAIDAAMEIAQFaAwGBGgMBQdoDAgGaAwHCGgMFAEAAAAFBAUHCAYXBAAAAAAAAAAW",                                                                                                                +
                     "smarts": "[#6]-[#8]-[#8]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "template": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
                 "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAJAAAACQAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAggAKAAAAAACBlAoAAAAAAEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgMAAAAAAAAAHAArBxAoAAAAAAIZDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAArBlAIAAAAAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsHECgAAAAAAhkNAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcACsGUAgAAAADGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAgACAwADBAAEBRgAGRwAAABTaW5nbGVPckRvdWJsZU9yQXJvbWF0aWNCb25kIRoBAAAAAAAAABwAKwYEGAAZHAAAAFNpbmdsZU9yRG91YmxlT3JBcm9tYXRpY0JvbmQhGgEAAAAAAAAAHAArBQdIDAgGGAAZHAAAAFNpbmdsZU9yRG91YmxlT3JBcm9tYXRpY0JvbmQhGgEAAAAAAAAAHAArBwgYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsUAQAAAAUEBQcIBhcEAAAAAAAAABY=",+
                 "smarts": "[#6]-[#8]-[#8]-[#8]-[#6&D3]1-,=,:[#7]:[#7]-,=,:[#6&D2]-,=,:[#6&D2]-,=,:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
             },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "modifiedAtoms": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 "5",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "7"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
             ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
             "modifiedBonds": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                 "4",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "5",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "7",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
                 "8"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
             ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
         }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
     ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
 
(1 row)

select mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol, false);
                                                                                                                                                                                                                                                                                                                                                                                                                              mol_to_xqmol                                                                                                                                                                                                                                                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
     "xqm_type": "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     "tautomers": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQKAAAAAMDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAiACA2gMAwRoDAQFaAwFBmgMBgJoDBQBAAAABQIDBAUGFwQAAAAAAAAAFg==",                                                                                                        +
             "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1 |LN:1:1.3|"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
         },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsHcCgAAAADAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAiACA2gMAwRoDAQFaAwFBmgMBgJoDBQBAAAABQIDBAUGFwQAAAAAAAAAFg==",                                                                                                        +
             "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1 |LN:1:1.3|"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
         }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
     ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "template": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
         "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwcQKAAAAAACGQ0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAKwcQKAAAAAACGQ0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAKwZQCAAAAAMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlAIAAAAAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQIgAgMYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsDBGgMBAUYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsFBhgAGRwAAABTaW5nbGVPckRvdWJsZU9yQXJvbWF0aWNCb25kIRoBAAAAAAAAABwAKwYCGAAZHAAAAFNpbmdsZU9yRG91YmxlT3JBcm9tYXRpY0JvbmQhGgEAAAAAAAAAHAArFAEAAAAFAgMEBQYXBAAAAAAAAAAW",+
         "smarts": "[#6]-[#8]-[#6&D3]1-,=,:[#7]:[#7]-,=,:[#6&D2]-,=,:[#6&D2]-,=,:1 |LN:1:1.3|"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
     },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "modifiedAtoms": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
         "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "4"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
     ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "modifiedBonds": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
         "2",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "4",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "5",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "6"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
     ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
 
(1 row)

select mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol, true, false);
                                                                                                                                                                                                                                                                                                                                                                                  mol_to_xqmol                                                                                                                                                                                                                                                                                                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
     "xqm_type": "2",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
     "mols": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBoAAAAAAEDCAAoAAAAAAIGUCgAAAAABBkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAwAAAAAAAAAcACsHUCgAAAADAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArB1A4AAAAAwEDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQIAAgNIDAQCSAwDBUgMBgRIDAUGSAwXBAAAAAAAAAAW",                                +
             "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
         },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAIAAAACAAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAgZQKAAAAAAEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQKAAAAAMDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwZQaAAAAAMDARkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsHUDgAAAADAQMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAgACAwADBEgMBQNIDAQGSAwHBUgMBgdIDBcEAAAAAAAAABY=",                +
             "smarts": "[#6]-[#8]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
         },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAJAAAACQAAAIABBgBoAAAAAAEDCAAoAAAAAAIIACgAAAAAAggAKAAAAAACBlAoAAAAAAQZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgMAAAAAAAAAHAArB1AoAAAAAwMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBwAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArCwABAAECAAIDAAMEAAQFSAwGBEgMBQdIDAgGSAwHCEgMFwQAAAAAAAAAFg==",+
             "smarts": "[#6]-[#8]-[#8]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
         }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
     ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
 
(1 row)

select mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol, false, false);
                                                                                                                                                                                                                                                                                                                                                                        mol_to_xqmol                                                                                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
     "xqm_type": "1",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +
     "mol": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
         "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQKAAAAAMDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAiACA2gMAwRoDAQFaAwFBmgMBgJoDBQBAAAABQIDBAUGFwQAAAAAAAAAFg==",+
         "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
 
(1 row)

select mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol, false, false, false);
                                                                                                mol_to_xqmol                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                                                                         +
     "xqm_type": "1",                                                                                                                                                                                      +
     "mol": {                                                                                                                                                                                              +
         "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZAKAAAAAMEB0AoAAAAAwMHQDgAAAADAQMGQGgAAAADAwEGQGgAAAADAwELAAEAAQIgAgNoDAMEaAwEBWgMBQZoDAYCaAwUAQAAAAUCAwQFBhcEAAAAAAAAABY=",+
         "smiles": "COc1cc[nH]n1"                                                                                                                                                                          +
     }                                                                                                                                                                                                     +
 }                                                                                                                                                                                                         +
 
(1 row)

-- substructure searching
select 'Cc1[nH]nc(F)c1'::mol @> mol_to_xqmol('Cc1n[nH]c(F)c1'::mol);
 ?column? 
----------
 t
(1 row)

select substruct('Cc1[nH]nc(F)c1'::mol,mol_to_xqmol('Cc1n[nH]c(F)c1'::mol));
 substruct 
-----------
 t
(1 row)

select substruct('Cc1[nH]nc(F)c1'::mol,mol_to_xqmol('Cc1n[nH]c(F)n1'::mol));
 substruct 
-----------
 f
(1 row)

select substruct('COC'::mol,'COC |LN:1:1.3|'::mol);
 substruct 
-----------
 t
(1 row)

select substruct('COC'::mol,mol_to_xqmol('COC |LN:1:1.3|'::mol));
 substruct 
-----------
 t
(1 row)

select substruct('COOC'::mol,'COC |LN:1:1.3|'::mol);
 substruct 
-----------
 f
(1 row)

select substruct('COOC'::mol,mol_to_xqmol('COC |LN:1:1.3|'::mol));
 substruct 
-----------
 t
(1 row)

select substruct('COOOC'::mol,mol_to_xqmol('COC |LN:1:1.3|'::mol));
 substruct 
-----------
 t
(1 row)

select substruct('COOOOC'::mol,mol_to_xqmol('COC |LN:1:1.3|'::mol));
 substruct 
-----------
 f
(1 row)

select 'COc1[nH]ncc1'@>mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol);
 ?column? 
----------
 t
(1 row)

select 'COc1[n][nH]cc1'@>mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol);
 ?column? 
----------
 t
(1 row)

select 'COOc1[nH]ncc1'@>mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol);
 ?column? 
----------
 t
(1 row)

select 'COOOc1[nH]ncc1'@>mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol);
 ?column? 
----------
 t
(1 row)

select 'COOOOc1[nH]ncc1'@>mol_to_xqmol('COC1=NNC=C1 |LN:1:1.3|'::mol);
 ?column? 
----------
 f
(1 row)

-- edge cases and error handling
select mol_to_xqmol('C1'::mol);
ERROR:  could not create molecule from SMILES 'C1'
LINE 1: select mol_to_xqmol('C1'::mol);
                            ^
select mol_to_xqmol('c1cc1'::mol);
ERROR:  MolToTautomerQuery: Can't kekulize mol.  Unkekulized atoms: 0 1 2
select mol_to_xqmol('COC1=NNC=C1'::mol);
                                                                                                                                                                                                                                                                                                                                                                                                                              mol_to_xqmol                                                                                                                                                                                                                                                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
     "xqm_type": "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     "tautomers": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQKAAAAAMDGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgcAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAiACA2gMAwRoDAQFaAwFBmgMBgJoDBQBAAAABQIDBAUGFwQAAAAAAAAAFg==",                                                                                                        +
             "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
             "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMEGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwdQOAAAAAMBAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsHcCgAAAADAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsGUGgAAAADAwEZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlBoAAAAAwMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoCAAAAAAAAABwAKwsAAQABAiACA2gMAwRoDAQFaAwFBmgMBgJoDBQBAAAABQIDBAUGFwQAAAAAAAAAFg==",                                                                                                        +
             "smarts": "[#6]-[#8]-[#6&D3]1:[#7&D2]:[#7&D2]:[#6&D2]:[#6&D2]:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
     ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "template": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
         "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAHAAAABwAAAIABBgBgAAAAAQMIACgAAAADAgZQKAAAAAMBGQcAAABBdG9tQW5kHhwCDQAAAEF0b21BdG9taWNOdW0hGgYAAAAAAAAAHAASAAAAQXRvbUV4cGxpY2l0RGVncmVlIRoDAAAAAAAAABwAKwcQKAAAAAACGQ0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAKwcQKAAAAAACGQ0AAABBdG9tQXRvbWljTnVtIRoHAAAAAAAAABwAKwZQCAAAAAMZBwAAAEF0b21BbmQeHAINAAAAQXRvbUF0b21pY051bSEaBgAAAAAAAAAcABIAAABBdG9tRXhwbGljaXREZWdyZWUhGgIAAAAAAAAAHAArBlAIAAAAAxkHAAAAQXRvbUFuZB4cAg0AAABBdG9tQXRvbWljTnVtIRoGAAAAAAAAABwAEgAAAEF0b21FeHBsaWNpdERlZ3JlZSEaAgAAAAAAAAAcACsLAAEAAQIgAgMYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsDBGgMBAUYABkcAAAAU2luZ2xlT3JEb3VibGVPckFyb21hdGljQm9uZCEaAQAAAAAAAAAcACsFBhgAGRwAAABTaW5nbGVPckRvdWJsZU9yQXJvbWF0aWNCb25kIRoBAAAAAAAAABwAKwYCGAAZHAAAAFNpbmdsZU9yRG91YmxlT3JBcm9tYXRpY0JvbmQhGgEAAAAAAAAAHAArFAEAAAAFAgMEBQYXBAAAAAAAAAAW",+
         "smarts": "[#6]-[#8]-[#6&D3]1-,=,:[#7]:[#7]-,=,:[#6&D2]-,=,:[#6&D2]-,=,:1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
     },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "modifiedAtoms": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
         "3",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "4"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
     ],                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     "modifiedBonds": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
         "2",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "4",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "5",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         "6"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
     ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
 
(1 row)

select 'CCOC1=NNC=C1'::mol@>mol_to_xqmol('COC1=NNC=C1'::mol);
 ?column? 
----------
 t
(1 row)

select mol_to_xqmol('CCCC'::mol);
                                                              mol_to_xqmol                                                              
----------------------------------------------------------------------------------------------------------------------------------------
 {                                                                                                                                     +
     "xqm_type": "1",                                                                                                                  +
     "mol": {                                                                                                                          +
         "pkl": "776t3gAAAAAOAAAAAQAAAAAAAAAEAAAAAwAAAIABBgBgAAAAAQMGAGAAAAACAgYAYAAAAAICBgBgAAAAAQMLAAEAAQIAAgMAFAAAAAAXBAAAAAAAAAAW",+
         "smiles": "CCCC"                                                                                                              +
     }                                                                                                                                 +
 }                                                                                                                                     +
 
(1 row)

select 'CCCCOC'::mol@>mol_to_xqmol('CCCC'::mol);
 ?column? 
----------
 t
(1 row)

-- interaction with the generic groups
select 'COC1=NNC(CC)=C1'::mol @>> mol_adjust_query_properties('COC1=NNC(*)=C1 |$;;;;;;AEL_p;$,LN:1:1.3|'::mol,
  '{"makeDummiesQueries":true, "setGenericQueryFromProperties": true}');
 ?column? 
----------
 f
(1 row)

select 'COC1=NNC(C=C)=C1'::mol @>> mol_adjust_query_properties('COC1=NNC(*)=C1 |$;;;;;;AEL_p;$,LN:1:1.3|'::mol,
  '{"makeDummiesQueries":true, "setGenericQueryFromProperties": true}');
 ?column? 
----------
 t
(1 row)

select 'COC1=NNC(CC)=C1'::mol @>> mol_to_xqmol(mol_adjust_query_properties('COC1=NNC(*)=C1 |$;;;;;;AEL_p;$,LN:1:1.3|'::mol,
  '{"makeDummiesQueries":true, "setGenericQueryFromProperties": true}'));
 ?column? 
----------
 f
(1 row)

select 'COC1=NNC(C=C)=C1'::mol @>> mol_to_xqmol(mol_adjust_query_properties('COC1=NNC(*)=C1 |$;;;;;;AEL_p;$,LN:1:1.3|'::mol,
  '{"makeDummiesQueries":true, "setGenericQueryFromProperties": true}'));
 ?column? 
----------
 t
(1 row)

select 'COOC1=NNC(CC)=C1'::mol @>> mol_to_xqmol(mol_adjust_query_properties('COC1=NNC(*)=C1 |$;;;;;;AEL_p;$,LN:1:1.3|'::mol,
  '{"makeDummiesQueries":true, "setGenericQueryFromProperties": true}'));
 ?column? 
----------
 f
(1 row)

select 'COOC1=NNC(C=C)=C1'::mol @>> mol_to_xqmol(mol_adjust_query_properties('COC1=NNC(*)=C1 |$;;;;;;AEL_p;$,LN:1:1.3|'::mol,
  '{"makeDummiesQueries":true, "setGenericQueryFromProperties": true}'));
 ?column? 
----------
 t
(1 row)

